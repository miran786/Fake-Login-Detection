# Architecture

> Auto-generated by /map on 2026-02-17

## Overview

Fake Login Detection is a **client-side React SPA** that simulates an ML-powered login security system. All data is stored in `localStorage` — there is no backend. It features sign-up/sign-in, OTP password recovery via EmailJS, a risk-scoring engine, and a security analytics dashboard.

```
┌─────────────────────────────────────────┐
│         UI Layer (React + Tailwind)     │
│   LoginPage · SignupPage · Dashboard    │
│         SecurityInfo · Shadcn UI        │
├─────────────────────────────────────────┤
│        State & Logic Layer              │
│   AuthContext (auth + login history)    │
│   useLocationData (IP geolocation)      │
├─────────────────────────────────────────┤
│           Utilities                     │
│   risk-engine (ML risk score sim)       │
│   email-service (EmailJS OTP + alerts)  │
├─────────────────────────────────────────┤
│         External Services               │
│   ipapi.co (IP/geo)  ·  EmailJS (mail) │
└─────────────────────────────────────────┘
│         Data: Browser localStorage      │
└─────────────────────────────────────────┘
```

## Components

### App (`src/App.tsx`)
- **Purpose:** Root component, view router (login / signup / dashboard), login/signup event handlers
- **Dependencies:** AuthContext, LoginPage, SignupPage, Dashboard, sonner toasts

### LoginPage (`src/components/login-page.tsx`)
- **Purpose:** Email/password login form, OTP password reset flow
- **Dependencies:** AuthContext (`checkUserExists`, `forceLogin`), email-service (`sendOTP`), Shadcn UI

### SignupPage (`src/components/signup-page.tsx`)
- **Purpose:** Registration with password-strength meter and validation (min 8 chars, upper/lower/number/special)
- **Dependencies:** Shadcn UI

### Dashboard (`src/components/dashboard.tsx`)
- **Purpose:** Post-login view showing login history, risk analytics, session info
- **Dependencies:** AuthContext (`loginHistory`), useLocationData, SecurityInfo, Recharts (not imported — uses custom badges/progress)

### SecurityInfo (`src/components/security-info.tsx`)
- **Purpose:** Displays current session device fingerprint + geo data
- **Dependencies:** useLocationData hook

### AuthContext (`src/context/AuthContext.tsx`)
- **Purpose:** Central auth state — user session, login/signup/logout, login history, failed attempt tracking, risk assessment
- **Dependencies:** risk-engine, email-service (suspicious alert), ipapi.co (via `fetchIpLocation`)

### Risk Engine (`src/utils/risk-engine.ts`)
- **Purpose:** Simulated ML risk scoring — new device (+40), new IP (+20), unusual hour (+15), velocity (+10), plus random noise
- **Dependencies:** None (pure function)

### Email Service (`src/utils/email-service.ts`)
- **Purpose:** EmailJS integration — OTP sending + suspicious login alerts
- **Dependencies:** @emailjs/browser

### useLocationData (`src/hooks/useLocationData.ts`)
- **Purpose:** Hook to fetch IP/city/region/country/ISP from ipapi.co
- **Dependencies:** None (fetch API)

## Data Flow

1. **Sign Up:** Form → `AuthContext.signup()` → `localStorage['registeredUsers']` → auto-login
2. **Login:** Form → `AuthContext.login()` → credential check → `fetchIpLocation()` → `calculateRiskScore()` → record `LoginAttempt` → if risk high: block; if invalid creds ×3: `sendSuspiciousLoginAlert()` → return result
3. **OTP Reset:** LoginPage sends OTP via `sendOTP()` → user enters code → `forceLogin()` bypasses password
4. **Dashboard:** Reads `loginHistory` from AuthContext → renders analytics

## Integration Points

| Service   | Type       | Purpose                     | Location                  |
|-----------|------------|-----------------------------|---------------------------|
| ipapi.co  | REST API   | IP address + geolocation    | AuthContext, useLocationData |
| EmailJS   | Client SDK | Send OTP + security alerts  | email-service.ts          |

## Technical Debt

- [ ] No backend — all data in localStorage (not production-safe)
- [ ] No automated tests
- [ ] `LocationInfo` interface defined in both `security-info.tsx` and `useLocationData.ts`
- [ ] Password stored as plaintext in localStorage
- [ ] Duplicate user-agent parsing logic in AuthContext and SecurityInfo
- [ ] No input sanitization on forms

## Conventions

**Naming:** PascalCase components, camelCase functions/variables, kebab-case filenames
**Structure:** Flat `src/components/` with page-level files + `ui/` sub-directory for Shadcn primitives
**State:** React Context + localStorage for persistence
**Styling:** Tailwind CSS v4 + CSS custom properties in `theme.css`
